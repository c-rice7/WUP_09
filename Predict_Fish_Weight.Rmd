---
title: "Weight of Fish"
author: "Connor Rice"
date: "`r Sys.Date()`"  
output: 
  html_document:
    number_sections: true
    toc: true
    toc_depth: 5

---

```{r include=FALSE,echo=FALSE}
require(tigerstats)
require(tidyverse)
require(car)
require(leaps)
```

# Predicting Fish Weight
```{r}
fish <- read.csv(file = "Fish.csv")
```

```{r eval=TRUE, echo=FALSE}
 
fish <- fish %>%
mutate(across(where(is.character), as.factor))
levels(fish$Species)
Bream <- filter(fish, Species == "Bream")
Bream <- select(Bream, -Species) 
Parkki <- filter(fish, Species == "Parkki")
Parkki <- select(Parkki, -Species) 
Perch <- filter(fish, Species == "Perch")
Perch <- select(Perch, -Species) 
Pike <- filter(fish, Species == "Pike")
Pike <- select(Pike, -Species) 
Roach <- filter(fish, Species == "Roach")
Roach <- select(Roach, -Species) 
Smelt <- filter(fish, Species == "Smelt")
Smelt <- select(Smelt, -Species) 
Whitefish <- filter(fish, Species == "Whitefish")
Whitefish <- select(Whitefish, -Species) 
```

# For each of the three species of fish listed below, determine the best regression model and also the best 2 element regression model. Use the BestSubset Regression helper file.


## Perch

```{r, echo=FALSE}
Perchfullup <- lm(Weight~ .,data=Perch)
summary.lm(Perchfullup)
```

### Best Models

```{r, echo=FALSE}
library(leaps)
regsubsets.out <-
    regsubsets(Weight ~ .,
               data = Perch,
               nbest = 1,       # 1 best model for each number of predictors
               nvmax = NULL,    # NULL for no limit on number of variables
               force.in = NULL, force.out = NULL,
               method = "exhaustive")

summary.out <- summary(regsubsets.out)
as.data.frame(summary.out$outmat)
library(car)
subsets(regsubsets.out,statistic="adjr2",legend="bottom",main="Adjusted R^2")
```
### Best Models

```{r, echo=FALSE}
which.max(summary.out$adjr2)
```
```{r, echo=FALSE}
summary.out$which[2,]
```

The best predictor model for Perch weight is a two element model made up of the height and width of the Perch. This model was selected as being the best based on its adjusted r-squared value of 0.94 which is the highest of the 2 element models and overall between the top models of each element count 1-5 for Perch Weight Prediction.


### Best Two regressor model

The best two element model for Perch is the same as its best overall model.

## Pike
```{r, echo=FALSE}
Pikefullup <- lm(Weight~ .,data=Pike)
summary.lm(Pikefullup)
```

### Best Models

```{r, echo=FALSE}
library(leaps)
regsubsets.out <-
    regsubsets(Weight ~ .,
               data = Pike,
               nbest = 1,       # 1 best model for each number of predictors
               nvmax = NULL,    # NULL for no limit on number of variables
               force.in = NULL, force.out = NULL,
               method = "exhaustive")

summary.out <- summary(regsubsets.out)
as.data.frame(summary.out$outmat)
library(car)
subsets(regsubsets.out,statistic="adjr2",legend="bottomright",main="Adjusted R^2")
```
```{r, echo=FALSE}
which.max(summary.out$adjr2)
```
```{r, echo=FALSE}
summary.out$which[5,]
```

The best predictor model for Pike weight is the five element model made up of all of the morphometric data of the Perch. This model was selected as being the best based on its adjusted r-squared value of 0.9794 which is the highest overall between the top models of each element count 1-5 for Perch Weight Prediction.

```{r, echo=FALSE}
best.model <- lm(Weight~Length1+Length2+Length3+Height+Width,data=Pike)
summary(best.model)
```

```{r, echo=FALSE}
best2.model <- lm(Weight~Length1+Length3,data=Pike)
summary(best2.model)
```

### Best Two regressor model

The best two element model is made up of Length-1 and Length-3 with an adjusted r-squared of 0.9649.

```{r, echo=FALSE}
anova(best2.model,best.model)
```

The p-value of 0.03091 generated by the anova comparison indicates that the difference between the accuracy of the best predictor model made up of all 5 pieces of morphometric data versus that of the best two element model is significant and that the 5 element model will be a statistically significant better predictor of pike weight.

## Roach
```{r, echo=FALSE}
Roachfullup <- lm(Weight~ .,data=Roach)
summary.lm(Roachfullup)
```

### Best Models

```{r, echo=FALSE}
library(leaps)
regsubsets.out <-
    regsubsets(Weight ~ .,
               data = Roach,
               nbest = 1,       # 1 best model for each number of predictors
               nvmax = NULL,    # NULL for no limit on number of variables
               force.in = NULL, force.out = NULL,
               method = "exhaustive")

summary.out <- summary(regsubsets.out)
as.data.frame(summary.out$outmat)
library(car)
subsets(regsubsets.out,statistic="adjr2",legend="bottomleft",main="Adjusted R^2")
```
```{r, echo=FALSE}
which.max(summary.out$adjr2)
```
```{r, echo=FALSE}
summary.out$which[2,]
```

The best predictor model for Roach weight is a two element model made up of the length-3 and width of the Roach. This model was selected as being the best based on its adjusted r-squared value of 0.8482 which is the highest of the 2 element models and overall between the top models of each element count 1-5 for Roach Weight Prediction.

```{r, echo=FALSE}
best.model <- lm(Weight~Width+Length3,data=Roach)
summary(best.model)
```


### Best Two regressor model

The best two element model for prediction of Roach weight is also its best overall model(length-3 and width).

## Final Summary Statements

Only for Pike did the two element model not represent the best overall model for prediction of weight. Both the Perch and Roach had a two element model as their best predictor of weight. However the prediction models for Roach weight were significantly less accurate on average based on their adjusted r-squared values compared to those of the models of the other two fish species.
